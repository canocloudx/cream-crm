<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C.R.E.A.M. COFFEE - CRM Dashboard</title>
    <meta name="description" content="C.R.E.A.M. COFFEE CRM - Stamps & Rewards">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Disabled for Cyberpunk Theme: <link rel="stylesheet" href="liquid-glass.css"> -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <img src="logo-icon.png" alt="C.R.E.A.M. Coffee" class="logo-img">

            </div>
            <button class="sidebar-toggle" id="sidebarToggle">
                <span class="material-icons-round">menu</span>
            </button>
        </div>

        <nav class="sidebar-nav">
            <a href="#" class="nav-item" data-page="transactions">
                <span class="material-icons-round">receipt_long</span>
                <span class="nav-text">Transactions</span>
            </a>
            <a href="#" class="nav-item active" data-page="members">
                <span class="material-icons-round">people</span>
                <span class="nav-text">Members</span>
            </a>
            <a href="#" class="nav-item" data-page="campaigns">
                <span class="material-icons-round">message</span>
                <span class="nav-text">Messages</span>
            </a>
            <a href="#" class="nav-item" data-page="settings">
                <span class="material-icons-round">settings</span>
                <span class="nav-text">Settings</span>
            </a>
        </nav>

                <div class="sidebar-footer">
            <!-- Logged Out State -->
            <div class="member-login-section" id="memberLoginSection">
                <button class="btn btn-outline staff-login-btn" onclick="openMemberLoginModal()">
                    <span class="material-icons-round">login</span>
                    <span class="btn-text">Login</span>
                </button>
            </div>
            
            <!-- Logged In State (hidden by default) -->
            <div class="member-profile-section hidden" id="memberProfileSection">
                <div class="user-info member-logged-in" onclick="openMemberProfileModal()">
                    <div class="user-avatar member-avatar" id="memberAvatar">--</div>
                    <div class="user-details">
                        <span class="user-name" id="memberDisplayName">Member</span>
                        <span class="user-role" id="memberDisplayId">CREAM-XXXXXX</span>
                    </div>
                    <span class="material-icons-round edit-icon">edit</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">

        <!-- Members Page -->
        <section class="page active" id="page-members">
            <header class="page-header">
                <div>
                    <h1>Members</h1>
                    <p class="subtitle">Manage your loyalty program members</p>
                </div>

            </header>

            <!-- Stats Row -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #9C7B6B, #B08E7D);">
                        <span class="material-icons-round">people</span>
                    </div>
                    <div class="stat-content">
                        <span class="stat-value" data-count="0" data-stat="totalMembers">0</span>
                        <span class="stat-label">Total Members</span>
                    </div>
                    <span class="stat-trend positive">+12.5%</span>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #6B9080, #5A7D6E);">
                        <span class="material-icons-round">local_cafe</span>
                    </div>
                    <div class="stat-content">
                        <span class="stat-value" data-count="0" data-stat="totalStamps">0</span>
                        <span class="stat-label">Stamps Given</span>
                    </div>
                    <span class="stat-trend positive">+8.3%</span>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #D4A574, #C29662);">
                        <span class="material-icons-round">card_giftcard</span>
                    </div>
                    <div class="stat-content">
                        <span class="stat-value" data-count="0" data-stat="totalRewards">0</span>
                        <span class="stat-label">Rewards Earned</span>
                    </div>
                    <span class="stat-trend positive">+15.2%</span>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #C27B7B, #A66969);">
                        <span class="material-icons-round">redeem</span>
                    </div>
                    <div class="stat-content">
                        <span class="stat-value" data-count="0" data-stat="redeemed">0</span>
                        <span class="stat-label">Rewards Redeemed</span>
                    </div>
                    <span class="stat-trend positive">+22.1%</span>
                </div>
            </div>

            <!-- Members Table -->
            <div class="card">
                <div class="card-toolbar">
                    <div class="search-box">
                        <span class="material-icons-round">search</span>
                        <input type="text" placeholder="Search members..." id="memberSearch">
                    </div>
                    <div class="filter-group">
                        <button class="btn btn-outline" onclick="exportData()">
                            <span class="material-icons-round">download</span>
                            Export
                        </button>
                    </div>
                </div>
                <table class="data-table" id="membersTable">
                    <thead>
                        <tr>
                            <th><input type="checkbox" class="checkbox"></th>
                            <th>Member</th>
                            <th>Member ID</th>
                            <th>Stamps</th>
                            <th>Rewards</th>
                            <th>Last Visit</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="membersTableBody"></tbody>
                </table>
            </div>
        </section>

        <!-- Campaigns Page -->
        <section class="page" id="page-campaigns">
            <header class="page-header">
                <div>
                    <h1>Messages</h1>
                    <p class="subtitle">Send messages to your members</p>
                </div>
            </header>

            <!-- Messages Section -->
            <div class="messages-section" id="messages-section">
                <div class="messages-layout">
                    <!-- Compose Message -->
                    <div class="card compose-card">
                        <h3>
                            <span class="material-icons-round">edit</span>
                            Compose Message
                        </h3>

                        <div class="form-group">
                            <label>Recipients</label>
                            <div class="recipient-options">
                                <label class="radio-option">
                                    <input type="radio" name="recipient" value="all" checked
                                        onchange="toggleRecipientSelect()">
                                    <span class="radio-label">All Members (2,847)</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="recipient" value="specific"
                                        onchange="toggleRecipientSelect()">
                                    <span class="radio-label">Specific Member</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group member-select-group" id="memberSelectGroup" style="display: none;">
                            <label>Search Member</label>
                            <div class="member-search-container">
                                <span class="material-icons-round search-icon">search</span>
                                <input type="text" class="form-input member-search" id="campaignMemberSearch" 
                                    placeholder="Type member name..." autocomplete="off"
                                    oninput="filterMembers(this, 'memberSuggestions')">
                                <input type="hidden" id="memberSelect" value="">
                                <div class="member-suggestions" id="memberSuggestions"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Message Title</label>
                            <input type="text" class="form-input" id="msgTitle"
                                placeholder="e.g., Special Offer Just for You!">
                        </div>

                        <div class="form-group">
                            <label>Message</label>
                            <textarea class="form-input textarea" id="msgBody" rows="4"
                                placeholder="Write your message here..." oninput="updateCharCount()"></textarea>
                            <span class="char-count" id="charCount">0/160 characters</span>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-secondary" onclick="previewMessage()">
                                <span class="material-icons-round">visibility</span>
                                Preview
                            </button>
                            <button class="btn btn-primary" onclick="sendMessage()">
                                <span class="material-icons-round">send</span>
                                Send Message
                            </button>
                        </div>
                    </div>

                    <!-- Recent Messages -->
                    <div class="card recent-messages-card">
                        <h3>
                            <span class="material-icons-round">history</span>
                            Recent Messages
                        </h3>
                        <div class="messages-list" id="messagesList">
                            <div class="message-item">
                                <div class="message-icon sent">
                                    <span class="material-icons-round">check_circle</span>
                                </div>
                                <div class="message-info">
                                    <span class="message-title">Weekend Double Stamps!</span>
                                    <span class="message-meta">Sent to All Members â€¢ Dec 13, 2024</span>
                                </div>
                                <span class="message-stats">2,847 delivered</span>
                            </div>
                            <div class="message-item">
                                <div class="message-icon sent">
                                    <span class="material-icons-round">check_circle</span>
                                </div>
                                <div class="message-info">
                                    <span class="message-title">Your Free Drink is Waiting!</span>
                                    <span class="message-meta">Sent to Sarah Chen â€¢ Dec 10, 2024</span>
                                </div>
                                <span class="message-stats">1 delivered</span>
                            </div>
                            <div class="message-item">
                                <div class="message-icon sent">
                                    <span class="material-icons-round">check_circle</span>
                                </div>
                                <div class="message-info">
                                    <span class="message-title">Welcome to C.R.E.A.M.!</span>
                                    <span class="message-meta">Sent to All Members â€¢ Dec 1, 2024</span>
                                </div>
                                <span class="message-stats">2,654 delivered</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </section>
        <!-- Transactions Page -->
        <section class="page" id="page-transactions">
            <header class="page-header">
                <div>
                    <h1>Transactions</h1>
                    <p class="subtitle">Live feed of all member activity</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="loadTransactions()">
                        <span class="material-icons-round">refresh</span>
                        Refresh
                    </button>
                    <button class="btn btn-primary" onclick="exportTransactionsToCSV()">
                        <span class="material-icons-round">download</span>
                        Export
                    </button>
                </div>
            </header>

            <div class="card">
                <div class="table-container">
                    <table class="data-table" id="transactionsTable">
                        <thead>
                            <tr>
                                <th>Member ID</th>
                                <th>Member Name</th>
                                <th>Transaction</th>
                                <th>Campaign</th>
                                <th>Type</th>
                                <th>Time</th>
                                <th>Pass</th>
                                <th>Shop</th>
                                <th>User</th>
                                <th>Panel</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsTableBody">
                            <tr><td colspan="10" style="text-align: center; padding: 40px;">Loading transactions...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Settings Page -->
                <section class="page" id="page-settings">
            <header class="page-header">
                <div>
                    <h1>Settings</h1>
                    <p class="subtitle">Configure your loyalty program</p>
                </div>
            </header>

            <!-- System Monitoring - Full Width at Top -->
            <div class="card settings-card monitoring-card-top" style="margin-bottom: 24px;">
                <div class="monitoring-top-content">
                    <div class="monitoring-info">
                        <span class="material-icons-round" style="font-size: 32px; color: var(--primary);">monitor_heart</span>
                        <div>
                            <h3 style="margin: 0;">System Monitoring</h3>
                            <p style="margin: 4px 0 0 0; color: var(--text-light);">Real-time health and performance metrics</p>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-sm" onclick="openMonitoringModal()">
                        <span class="material-icons-round">dashboard</span>
                        View Dashboard
                    </button>
                </div>
            </div>

            <div class="settings-columns">
                <!-- Left Column: Stores + QR Codes -->
                <div class="settings-column">
                    <div class="card settings-card stores-section">
                        <div class="settings-icon">
                            <span class="material-icons-round">storefront</span>
                        </div>
                        <h3>Stores</h3>
                        <p>Manage your coffee shop locations</p>
                        <button class="btn btn-primary btn-sm" onclick="openStoreModal()">
                            <span class="material-icons-round">add_business</span>
                            Add Store
                        </button>
                        <div class="stores-list" id="storesList">
                            <div class="store-list-header">
                                <span class="stores-count">Loading...</span>
                            </div>
                        </div>
                    </div>

                    <div class="card settings-card">
                        <div class="settings-icon">
                            <span class="material-icons-round">qr_code_2</span>
                        </div>
                        <h3>QR Codes</h3>
                        <p>View survey QR codes for members</p>
                        <button class="btn btn-primary btn-sm" onclick="openQRCodesModal()">View QR Codes</button>
                    </div>
                </div>

                <!-- Right Column: Users -->
                <div class="settings-column">
                    <div class="card settings-card users-section">
                        <div class="settings-icon">
                            <span class="material-icons-round">group_add</span>
                        </div>
                        <h3>Users</h3>
                        <p>Manage staff accounts (Owners & Baristas)</p>
                        <button class="btn btn-primary btn-sm" onclick="openUserModal()">
                            <span class="material-icons-round">person_add</span>
                            Add User
                        </button>
                        <div class="users-list" id="usersList">
                            <div class="user-list-header">
                                <span class="users-count">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section></main>

    <!-- Member Detail Modal -->
    <div class="modal-overlay hidden" id="modalOverlay">
        <div class="modal">
            <div class="modal-header">
                <h2 id="modalTitle">Member Details</h2>
                <button class="modal-close" id="modalClose">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <!-- Login Modal -->
    <div class="modal-overlay hidden" id="memberLoginModalOverlay">
        <div class="modal member-login-modal">
            <div class="modal-header">
                <h2><span class="material-icons-round">login</span> Login</h2>
                <button class="modal-close" onclick="closeMemberLoginModal()">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="memberLoginForm" onsubmit="handleMemberLogin(event)">
                    <div class="form-group">
                        <label for="memberLoginEmail">Email</label>
                        <input type="email" class="form-input" id="memberLoginEmail" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="memberLoginPassword">Password</label>
                        <div class="password-input-wrapper">
                            <input type="password" class="form-input" id="memberLoginPassword" placeholder="Enter your password" required>
                            <button type="button" class="password-toggle" onclick="toggleMemberPasswordVisibility('memberLoginPassword')">
                                <span class="material-icons-round">visibility_off</span>
                            </button>
                        </div>
                    </div>
                    <div class="form-group login-error hidden" id="memberLoginError">
                        <span class="material-icons-round">error</span>
                        <span id="memberLoginErrorText">Invalid credentials</span>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="openSetPasswordModal()">Set Password</button>
                        <button type="submit" class="btn btn-primary">
                            <span class="material-icons-round">login</span>
                            Login
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Member Profile Modal -->
    <div class="modal-overlay hidden" id="memberProfileModalOverlay">
        <div class="modal member-profile-modal">
            <div class="modal-header">
                <h2><span class="material-icons-round">person</span> My Profile</h2>
                <button class="modal-close" onclick="closeMemberProfileModal()">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">--</div>
                    <div class="profile-info">
                        <h3 id="profileName">Member Name</h3>
                        <span class="member-id-badge" id="profileMemberId">CREAM-XXXXXX</span>
                    </div>
                </div>
                <div class="profile-stats">
                    <div class="profile-stat">
                        <span class="stat-value" id="profileStamps">0</span>
                        <span class="stat-label">Stamps</span>
                    </div>
                    <div class="profile-stat">
                        <span class="stat-value" id="profileRewards">0</span>
                        <span class="stat-label">Rewards</span>
                    </div>
                </div>
                <form id="memberProfileForm" onsubmit="handleMemberProfileUpdate(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="profileEditName">Name</label>
                            <input type="text" class="form-input" id="profileEditName" required>
                        </div>
                        <div class="form-group">
                            <label for="profileEditPhone">Phone</label>
                            <input type="tel" class="form-input" id="profileEditPhone">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="profileEditBirthday">Birthday</label>
                            <input type="date" class="form-input" id="profileEditBirthday">
                        </div>
                        <div class="form-group">
                            <label for="profileEditGender">Gender</label>
                            <select class="form-input" id="profileEditGender">
                                <option value="">Select...</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                                <option value="other">Other</option>
                                <option value="prefer_not_to_say">Prefer not to say</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" class="form-input" id="profileEditEmail" disabled>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-danger" onclick="handleMemberLogout()">
                            <span class="material-icons-round">logout</span>
                            Logout
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <span class="material-icons-round">save</span>
                            Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Set Password Modal -->
    

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- Add User Modal -->
    <div class="modal-overlay hidden" id="userModalOverlay">
        <div class="modal user-modal">
            <div class="modal-header">
                <h2>Add New User</h2>
                <button class="modal-close" onclick="closeUserModal()">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="addUserForm" onsubmit="addUser(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="userName">Name</label>
                            <input type="text" class="form-input" id="userName" placeholder="Enter first name" required>
                        </div>
                        <div class="form-group">
                            <label for="userSurname">Surname</label>
                            <input type="text" class="form-input" id="userSurname" placeholder="Enter last name"
                                required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="userEmail">Email</label>
                        <input type="email" class="form-input" id="userEmail" placeholder="Enter email address"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="userPassword">Password</label>
                        <div class="password-input-wrapper">
                            <input type="password" class="form-input" id="userPassword" placeholder="Create a password"
                                required minlength="6">
                            <button type="button" class="password-toggle" onclick="togglePasswordVisibility()">
                                <span class="material-icons-round">visibility_off</span>
                            </button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="userPhone">Phone Number</label>
                        <input type="tel" class="form-input" id="userPhone" placeholder="Enter phone number" required>
                    </div>
                    <div class="form-group">
                        <label for="userType">User Type</label>
                        <select class="form-input" id="userType" required>
                            <option value="">Select user type...</option>
                            <option value="owner">ðŸ‘‘ Owner</option>
                            <option value="barista">â˜• Barista</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeUserModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <span class="material-icons-round">person_add</span>
                            Add User
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- QR Codes Modal -->
    <div class="modal-overlay hidden" id="qrCodesModalOverlay">
        <div class="modal qr-codes-modal">
            <div class="modal-header">
                <h2>Registration QR Codes</h2>
                <button class="modal-close" onclick="closeQRCodesModal()">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <p class="qr-modal-subtitle">Scan this QR code to join the loyalty program</p>
                <div class="qr-codes-grid">
                    <div class="qr-code-card">
                        <div class="qr-code-image">
                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=https://crm.creamcoff.com/register.html"
                                alt="Member Survey QR">
                        </div>
                        <div class="qr-code-info">
                            <h4>â˜• C.R.E.A.M. Member</h4>
                            <p>For regular loyalty members</p>
                        </div>
                        <button class="btn btn-secondary btn-sm" onclick="downloadQR('member')">
                            <span class="material-icons-round">download</span>
                            Download
                        </button>
                    </div>
                    <div class="qr-code-card">
                        <div class="qr-code-image">
                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=https://crm.creamcoff.com/register.html"
                                alt="Elite Member Survey QR">
                        </div>
                        <div class="qr-code-info">
                            <h4>ðŸ‘‘ C.R.E.A.M. Elite Member</h4>
                            <p>For elite loyalty members</p>
                        </div>
                        <button class="btn btn-secondary btn-sm" onclick="downloadQR('elite')">
                            <span class="material-icons-round">download</span>
                            Download
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Store Modal -->
    <div class="modal-overlay hidden" id="storeModalOverlay">
        <div class="modal store-modal">
            <div class="modal-header">
                <h2>Add New Store</h2>
                <button class="modal-close" onclick="closeStoreModal()">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="addStoreForm" onsubmit="addStore(event)">
                    <div class="form-group">
                        <label for="storeName">Store Name</label>
                        <input type="text" class="form-input" id="storeName" placeholder="e.g., C.R.E.A.M. Downtown"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="storeAddress">Address</label>
                        <input type="text" class="form-input" id="storeAddress" placeholder="Enter full address"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="storeManager">Manager</label>
                        <input type="text" class="form-input" id="storeManager" placeholder="Manager's full name"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="storePhone">Phone</label>
                        <input type="tel" class="form-input" id="storePhone" placeholder="Phone number" required>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeStoreModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <span class="material-icons-round">add_business</span>
                            Add Store
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <style>
        /* Settings Columns Layout */
        .settings-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .settings-column {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        @media (max-width: 900px) {
            .settings-columns {
                grid-template-columns: 1fr;
            }
        }

        /* Stores Section Styles */
        .stores-list {
            margin-top: 16px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            padding: 12px;
        }

        .store-list-header {
            padding: 8px 12px;
            border-bottom: 1px solid rgba(45, 41, 38, 0.1);
            margin-bottom: 8px;
        }

        .stores-count {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-medium);
        }

        .store-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 14px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 10px;
            margin-bottom: 8px;
            transition: all 0.2s ease;
        }

        .store-item:hover {
            background: rgba(255, 255, 255, 0.9);
        }

        .store-item:last-child {
            margin-bottom: 0;
        }

        .store-item-icon {
            width: 42px;
            height: 42px;
            border-radius: 10px;
            background: linear-gradient(135deg, #9C7B6B, #B08E7D);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            flex-shrink: 0;
        }

        .store-item-icon .material-icons-round {
            font-size: 22px;
        }

        .store-item-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .store-item-name {
            font-weight: 600;
            font-size: 15px;
            color: var(--text-dark);
        }

        .store-item-address {
            font-size: 13px;
            color: var(--text-medium);
        }

        .store-item-manager,
        .store-item-phone {
            font-size: 12px;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .store-item-manager .material-icons-round,
        .store-item-phone .material-icons-round {
            font-size: 14px;
        }

        .store-actions {
            display: flex;
            gap: 4px;
        }

        .btn-edit-store,
        .btn-delete-store {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-light);
            padding: 8px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .btn-edit-store:hover {
            background: rgba(156, 123, 107, 0.15);
            color: #9C7B6B;
        }

        .btn-delete-store:hover {
            background: rgba(194, 123, 123, 0.15);
            color: #C27B7B;
        }

        .btn-edit-store .material-icons-round,
        .btn-delete-store .material-icons-round {
            font-size: 20px;
        }

        .store-modal {
            max-width: 480px;
        }

        .users-list {
            margin-top: 16px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 12px;
            padding: 12px;
        }

        .user-list-header {
            padding: 8px 12px;
            border-bottom: 1px solid rgba(45, 41, 38, 0.1);
            margin-bottom: 8px;
        }

        .users-count {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-medium);
        }

        .user-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 10px;
            margin-bottom: 8px;
            transition: all 0.2s ease;
        }

        .user-item:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(4px);
        }

        .user-item:last-child {
            margin-bottom: 0;
        }

        .user-item-avatar {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            color: white;
        }

        .user-item-avatar.owner {
            background: linear-gradient(135deg, #D4A574, #C29662);
        }

        .user-item-avatar.barista {
            background: linear-gradient(135deg, #9C7B6B, #B08E7D);
        }

        .user-item-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .user-item-name {
            font-weight: 600;
            font-size: 14px;
            color: var(--text-dark);
        }

        .user-item-email {
            font-size: 12px;
            color: var(--text-light);
        }

        .user-type-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .user-type-badge.owner {
            background: linear-gradient(135deg, rgba(212, 165, 116, 0.2), rgba(194, 150, 98, 0.2));
            color: #C29662;
        }

        .user-type-badge.barista {
            background: linear-gradient(135deg, rgba(156, 123, 107, 0.2), rgba(176, 142, 125, 0.2));
            color: #9C7B6B;
        }

        /* User Action Buttons */
        .user-actions {
            display: flex;
            gap: 4px;
            margin-left: 8px;
        }

        .btn-edit-user,
        .btn-delete-user {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-light);
            padding: 8px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .btn-edit-user:hover {
            background: rgba(156, 123, 107, 0.15);
            color: #9C7B6B;
        }

        .btn-delete-user:hover {
            background: rgba(194, 123, 123, 0.15);
            color: #C27B7B;
        }

        .btn-edit-user .material-icons-round,
        .btn-delete-user .material-icons-round {
            font-size: 20px;
        }

        /* User Modal Styles */
        .user-modal {
            max-width: 500px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .password-input-wrapper {
            position: relative;
        }

        .password-input-wrapper .form-input {
            padding-right: 48px;
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-light);
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s ease;
        }

        .password-toggle:hover {
            color: var(--text-dark);
        }

        @media (max-width: 768px) {
            .users-section {
                grid-column: span 1;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .qr-codes-grid {
                grid-template-columns: 1fr;
            }
        }

        /* QR Codes Modal Styles */
        .qr-codes-modal {
            max-width: 650px;
        }

        .qr-modal-subtitle {
            text-align: center;
            color: var(--text-medium);
            margin-bottom: 24px;
        }

        .qr-codes-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .qr-code-card {
            background: rgba(255, 255, 255, 0.6);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(45, 41, 38, 0.08);
            transition: all 0.2s ease;
        }

        .qr-code-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(45, 41, 38, 0.1);
        }

        .qr-code-image {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            display: inline-block;
        }

        .qr-code-image img {
            display: block;
            width: 150px;
            height: 150px;
        }

        .qr-code-info h4 {
            font-size: 14px;
            margin-bottom: 4px;
            color: var(--text-dark);
        }

        .qr-code-info p {
            font-size: 12px;
            color: var(--text-light);
            margin-bottom: 12px;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 13px;
        }
    </style>

    <script src="app.js?v=1768118216"></script>

    <!-- Monitoring Modal -->
    <div class="modal-overlay hidden" id="monitoringModalOverlay">
        <div class="modal monitoring-modal" style="max-width: 1200px; width: 95%;">
            <div class="modal-header">
                <h2>
                    <span class="material-icons-round" style="margin-right: 8px;">monitor_heart</span>
                    System Monitoring
                </h2>
                <button class="modal-close" onclick="closeMonitoringModal()">
                    <span class="material-icons-round">close</span>
                </button>
            </div>
            <div class="modal-body" id="monitoringModalBody">
                <!-- Status Cards -->
                <div class="monitoring-status-grid">
                    <div class="monitoring-card status-card" id="serverStatus">
                        <div class="status-indicator healthy"></div>
                        <div class="status-content">
                            <span class="status-label">Server</span>
                            <span class="status-value" id="serverStatusText">Checking...</span>
                        </div>
                    </div>
                    <div class="monitoring-card status-card" id="dbStatus">
                        <div class="status-indicator healthy"></div>
                        <div class="status-content">
                            <span class="status-label">Database</span>
                            <span class="status-value" id="dbStatusText">Checking...</span>
                        </div>
                    </div>
                    <div class="monitoring-card metric-card">
                        <span class="material-icons-round metric-icon">speed</span>
                        <div class="metric-content">
                            <span class="metric-value" id="dbLatency">--</span>
                            <span class="metric-label">DB Latency</span>
                        </div>
                    </div>
                    <div class="monitoring-card metric-card">
                        <span class="material-icons-round metric-icon">timer</span>
                        <div class="metric-content">
                            <span class="metric-value" id="responseTime">--</span>
                            <span class="metric-label">API Response</span>
                        </div>
                    </div>
                </div>

                <!-- Info Cards Row -->
                <div class="monitoring-info-grid">
                    <!-- System Info Card -->
                    <div class="card monitoring-detail-card">
                        <h3>
                            <span class="material-icons-round">dns</span>
                            System Information
                        </h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">Uptime</span>
                                <span class="detail-value" id="systemUptime">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Node.js</span>
                                <span class="detail-value" id="nodeVersion">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Platform</span>
                                <span class="detail-value" id="systemPlatform">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Process ID</span>
                                <span class="detail-value" id="processPid">--</span>
                            </div>
                        </div>
                    </div>

                    <!-- Memory Card -->
                    <div class="card monitoring-detail-card">
                        <h3>
                            <span class="material-icons-round">memory</span>
                            Memory Usage
                        </h3>
                        <div class="memory-bar-container">
                            <div class="memory-bar" id="memoryBar" style="width: 0%"></div>
                        </div>
                        <div class="memory-stats">
                            <span id="memoryUsed">-- MB</span> / <span id="memoryTotal">-- MB</span>
                            <span class="memory-percent" id="memoryPercent">--%</span>
                        </div>
                        <div class="detail-grid" style="margin-top: 16px;">
                            <div class="detail-item">
                                <span class="detail-label">RSS</span>
                                <span class="detail-value" id="memoryRss">-- MB</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">External</span>
                                <span class="detail-value" id="memoryExternal">-- MB</span>
                            </div>
                        </div>
                    </div>

                    <!-- Database Pool Card -->
                    <div class="card monitoring-detail-card">
                        <h3>
                            <span class="material-icons-round">storage</span>
                            Database Pool
                        </h3>
                        <div class="detail-grid">
                            <div class="detail-item">
                                <span class="detail-label">Total</span>
                                <span class="detail-value" id="poolTotal">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Idle</span>
                                <span class="detail-value" id="poolIdle">--</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Waiting</span>
                                <span class="detail-value" id="poolWaiting">--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Business Metrics -->
                <div class="card monitoring-metrics-card" style="margin-bottom: 20px;">
                    <h3>
                        <span class="material-icons-round">analytics</span>
                        Business Metrics
                    </h3>
                    <div class="business-metrics-grid">
                        <div class="business-metric">
                            <span class="business-metric-value" id="metricMembers">--</span>
                            <span class="business-metric-label">Total Members</span>
                        </div>
                        <div class="business-metric">
                            <span class="business-metric-value" id="metricStamps">--</span>
                            <span class="business-metric-label">Total Stamps</span>
                        </div>
                        <div class="business-metric">
                            <span class="business-metric-value" id="metricRewards">--</span>
                            <span class="business-metric-label">Total Rewards</span>
                        </div>
                        <div class="business-metric">
                            <span class="business-metric-value" id="metricToday">--</span>
                            <span class="business-metric-label">New Today</span>
                        </div>
                        <div class="business-metric">
                            <span class="business-metric-value" id="metricTransactions">--</span>
                            <span class="business-metric-label">24h Transactions</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Links -->
                <div class="monitoring-links">
                    <a href="/api-docs" target="_blank" class="monitoring-link-btn">
                        <span class="material-icons-round">menu_book</span>
                        API Documentation
                    </a>
                    <a href="/metrics" target="_blank" class="monitoring-link-btn">
                        <span class="material-icons-round">data_object</span>
                        Raw Metrics
                    </a>
                    <button class="monitoring-link-btn" onclick="loadMonitoringData()">
                        <span class="material-icons-round">refresh</span>
                        Refresh
                    </button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>